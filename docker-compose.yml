version: "3.5"
services:
  redis:
    container_name: remote_dictionary
    image: "redis:alpine"
    hostname: remote_dictionary
    ports:
      - 6379:6379
    networks:
      - context_net
  rabbit_mq:
    container_name: rabbitmq-broker
    image:  "rabbitmq:3-management"
    hostname: rabbitmq-broker
    ports:
      - 5672:5672
      - 15672:15672
    environment:
      - RABBITMQ_DEFAULT_USER=omar
      - RABBITMQ_DEFAULT_PASS=omar
    networks:
      - context_net
      - phoros_net

  zos_context:
    container_name: zos_context
    hostname: zos_context
    build:  .
    stdin_open: true # docker run -i
    tty: true        # docker run -t
    volumes:
      - .:/code
    ports:
      - 6061:6060
    environment:
      - CONTEXT_RPC_PORT=6060
      - CONTEXT_RPC_HOST=zos_context
      - RABBIT_MQ_HOST=rabbitmq-broker
      - RABBIT_MQ_USER=omar
      - RABBIT_MQ_PASSWORD=omar
      - RABBIT_MQ_PORT=5672
      - REDIS_HOST=localhost
      - REDIS_PORT=6379
      - ZOS_CONTEXT_ID=1
    networks:
      - context_net
      - phoros_net

networks: # put in mind that you should create the external networks..
  context_net:
    external: true
  phoros_net:
    external: true

  